<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Softdrink</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1{font-size:1.7em;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project >section img{max-width:100%;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:8em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.project #system #author label{vertical-align:top;}article.project #system #author ul{display:inline-block;margin:0;padding:0;list-style:none;}article.project #toc nav>*{margin-left:1em;display:block;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}@media (min-width: 1300px){html body{padding-left:16em;}article.project #toc{margin:0;position:fixed;left:0;top:0;bottom:0;width:15em;overflow-y:auto;background:#F0F0F0;border-right:1px solid #A0A0A0;}}</style> </head> <body> <article class="project"> <header>   <h1>softdrink</h1>   <span class="version">0.1.0</span>    <p class="description">Tools to inline or extract CSS into/from HTML.</p>   </header> <section id="toc"> <h2>Table of Contents</h2> <nav> <a href="#project">Top</a>  <a href="#documentation">Documentation</a> <nav> <a href="#about_softdrink">About Softdrink</a>  <a href="#how_to">How To</a>  <a href="#see_also">See Also</a> </nav>  <a href="#system">System</a>  <a href="#system">Packages</a> <nav> <a href="#PACKAGE%20SOFTDRINK">SOFTDRINK</a> </nav>  </nav> </section>  <section id="documentation"><h2 id="about_softdrink">About Softdrink</h2> <p>Softdrink is a small toolkit to extract CSS from HTML or inline it. Softdrink relies on <a href="http://shinmera.github.io/lquery/">lQuery</a> and <a href="http://shinmera.github.io/LASS/">LASS</a>.</p> <h2 id="how_to">How To</h2> <p>Extracting style information happens with <code><a href="#FUNCTION%20SOFTDRINK%3ASLURP" class="xref">slurp</a></code>.</p> <pre><code>(<a href="#FUNCTION%20SOFTDRINK%3ASLURP" class="xref">softdrink:slurp</a> &quot;&lt;div&gt;&lt;foo/&gt;&lt;foo id=\&quot;bla\&quot; style=\&quot;bar:baz;bluh: bbab\&quot; /&gt;&lt;/div&gt;&quot;)
</code></pre> <p>Injecting CSS back in happens with <code><a href="#FUNCTION%20SOFTDRINK%3AMIX" class="xref">mix</a></code>. You can then prettify the output with <code><a href="#FUNCTION%20SOFTDRINK%3APOUR" class="xref">pour</a></code>.</p> <pre><code>(<a href="#FUNCTION%20SOFTDRINK%3APOUR" class="xref">softdrink:pour</a> (<a href="#FUNCTION%20SOFTDRINK%3AMIX" class="xref">softdrink:mix</a> &quot;&lt;foo&gt;&lt;p/&gt;&lt;/foo&gt;&quot; '(p :text-decoration underline)))
</code></pre> <p>Softdrink includes support for the LASS item-types <code>:BLOCK</code> and <code>:PROPERTY</code>. Any other type needs to be added with <code><a href="#MACRO-FUNCTION%20SOFTDRINK%3ADEFINE-INLINER" class="xref">DEFINE-INLINER</a></code> or <code><a href="#MACRO-FUNCTION%20SOFTDRINK%3ADEFINE-MANIPULATOR" class="xref">DEFINE-MANIPULATOR</a></code>.</p> <h2 id="see_also">See Also</h2> <ul> <li><a href="http://shinmera.github.io/lquery/">lQuery</a>, used to easily traverse and manipulate the DOM</li> <li><a href="http://shinmera.github.io/LASS/">LASS</a>, to process and markup CSS in a more Lispy manner.</li> <li><a href="http://shinmera.github.io/plump/">Plump</a>, to parse and serialize X(HT)ML.</li> </ul> </section>    <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">0.1.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external" href="https://Shinmera.github.io/lquery/">lquery</a></li><li><a class="external" href="https://Shinmera.github.io/LASS/">lass</a></li></ul> </div>   <div class="row" id="author"> <label for="author">Author:</label> <a href="mailto:shinmera@tymoon.eu">Yukari Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/LICENSE">zlib</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shinmera.github.io/softdrink/">https://Shinmera.github.io/softdrink/</a> </div>   <div class="row"> <label for="bug-tracker">Bug Tracker:</label> <a id="bug-tracker" href="https://github.com/Shinmera/softdrink/issues">https://github.com/Shinmera/softdrink/issues</a> </div>   <div class="row"> <label for="sources">Sources:</label> <a id="sources" href="https://github.com/Shinmera/softdrink.git">https://github.com/Shinmera/softdrink.git</a> </div>  </section>    <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE SOFTDRINK"> <header> <h3> <a href="#PACKAGE%20SOFTDRINK">SOFTDRINK</a> </h3> <ul class="nicknames"> <li>ORG.TYMOONNEXT.SOFTDRINK</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:EXTRACT-SHEET"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AEXTRACT-SHEET">EXTRACT-SHEET</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">ROOT</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">MODIFY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/extract.lisp#L28">Source</a>  </header> <div class="docstring"><pre>Extract style elements from ROOT into a LASS sheet.

If MODIFY is non-NIL the STYLE attributes are removed.

Returns two values: the LASS sheet and the ROOT.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:INLINE-BLOCK"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AINLINE-BLOCK">INLINE-BLOCK</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">ROOT</li>    <li class="argument">BLOCK</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L57">Source</a>  </header> <div class="docstring"><pre>Inlines the given LASS block into the ROOT node.
Returns the ROOT.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:INLINE-SHEET"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AINLINE-SHEET">INLINE-SHEET</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">LASS-SHEET</li>    <li class="argument">ROOT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L75">Source</a>  </header> <div class="docstring"><pre>Inlines the given LASS-SHEET into the ROOT node.
Returns the ROOT.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:INLINER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AINLINER">INLINER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L35">Source</a>  </header> <div class="docstring"><pre>Returns a function to use as an inliner. The TYPE is automatically converted to a keyword.
If no fitting function can be found, a noop-function is returned.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:(SETF INLINER)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3A%28SETF%20INLINER%29">(SETF INLINER)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L41">Source</a>  </header> <div class="docstring"><pre>Set a new inliner function. The TYPE is automatically converted to a keyword.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:MANIPULATE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AMANIPULATE">MANIPULATE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NODE</li>    <li class="argument">ITEM</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L28">Source</a>  </header> <div class="docstring"><pre>Manipulate the NODE with the given ITEM.
Returns the NODE.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:MANIPULATOR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AMANIPULATOR">MANIPULATOR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L6">Source</a>  </header> <div class="docstring"><pre>Returns a function to use as a manipulator. The TYPE is automatically converted to a keyword.
If no fitting function can be found, a noop-function is returned.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:(SETF MANIPULATOR)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3A%28SETF%20MANIPULATOR%29">(SETF MANIPULATOR)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L12">Source</a>  </header> <div class="docstring"><pre>Set a new manipulator function. The TYPE is automatically converted to a keyword.</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:MIX"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3AMIX">MIX</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">LASS-SHEET</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L82">Source</a>  </header> <div class="docstring"><pre>Mixes the LASS-SHEET definition into the SOURCE.
Returns a NODE.

Source can either be a NODE or something PARSEable.

See PLUMP:PARSE, LASS:COMPILE-SHEET</pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:POUR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3APOUR">POUR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NODE</li>    <li class="argument lambda-list-keyword">&amp;OPTIONAL</li>    <li class="argument">STREAM</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L95">Source</a>  </header> <div class="docstring"><pre>Serializes NODE into STREAM.

STREAM can either be an object of type STREAM,
NIL (to string), or T (to *standard-output*).

See <a href="https://Shinmera.github.io/plump/#FUNCTION%20PLUMP%3ASERIALIZE" class="xref">PLUMP:SERIALIZE</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION SOFTDRINK:SLURP"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20SOFTDRINK%3ASLURP">SLURP</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">SOURCE</li>    <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">STREAM</li>    <li class="argument">PRETTY</li>    <li class="argument">MODIFY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/extract.lisp#L46">Source</a>  </header> <div class="docstring"><pre>Slurp all style information from SOURCE into STREAM.

SOURCE --- can be either a NODE or something PLUMP:PARSEable.
STREAM --- Where to output the CSS to. See <a href="https://Shinmera.github.io/LASS/#FUNCTION%20LASS%3AWRITE-SHEET" class="xref">LASS:WRITE-SHEET</a>
PRETTY --- Whether to prettify CSS or not. See <a href="https://Shinmera.github.io/LASS/#FUNCTION%20LASS%3AWRITE-SHEET" class="xref">LASS:WRITE-SHEET</a>
MODIFY --- Whether to modify the root or not. See <a href="#FUNCTION%20SOFTDRINK%3AEXTRACT-SHEET" class="xref">EXTRACT-SHEET</a>

Returns two values: The ourput of WRITE-SHEET and the ROOT.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION SOFTDRINK:DEFINE-INLINER"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20SOFTDRINK%3ADEFINE-INLINER">DEFINE-INLINER</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <ul class="arguments"> <li class="argument">ROOT</li>  <li class="argument lambda-list-keyword">&amp;REST</li>  <li class="argument">ARGS</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L46">Source</a>  </header> <div class="docstring"><pre>Defines a new inliner.

NAME --- The inliner's name, automatically converted to a keyword.
ROOT --- Symbol bound to the root node to process.
ARGS --- Lambda-list for the manipulator arguments.</pre></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION SOFTDRINK:DEFINE-MANIPULATOR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20SOFTDRINK%3ADEFINE-MANIPULATOR">DEFINE-MANIPULATOR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NAME</li>    <ul class="arguments"> <li class="argument">ELEMENT</li>  <li class="argument lambda-list-keyword">&amp;REST</li>  <li class="argument">ARGS</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shinmera/softdrink/blob/1cc5b9b5988ea0301fd4ddee5e0dc35113da6f38/inline.lisp#L17">Source</a>  </header> <div class="docstring"><pre>Defines a new manipulator.

NAME    --- The manipulator's name, automatically converted to a keyword.
ELEMENT --- Symbol bound to the element to process.
ARGS    --- Lambda-list for the manipulator arguments.</pre></div> </article> </li> </ul> </article> </li> </ul> </section>  </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 